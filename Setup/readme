


Apache
/var/www/mydomain.com/index.html
<html>
    <head>
        <title>Welcome to your_domain!</title>
    </head>
    <body>
        <h1>Success!  The your_domain virtual host is working!</h1>
    </body>
</html>

/etc/apache2/sites-available/mydomain.com.conf
<VirtualHost *:80>
    ServerAdmin admin@mydomain.com
    ServerName mydomain.com
    ServerAlias www.mydomain.com
    DocumentRoot /var/www/mydomain.com
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
(Let’s encrypt add more and creates the next file, which also has the gbridge redirect lines added)


/etc/apache2/sites-available/mydomain.com-le-ssl.conf
<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerAdmin admin@mydomain.com
    ServerName mydomain.com
    ServerAlias www.mydomain.com
    DocumentRoot /var/www/mydomain.com
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined


Include /etc/letsencrypt/options-ssl-apache.conf
SSLCertificateFile /etc/letsencrypt/live/mydomain.com/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/mydomain.com/privkey.pem


</VirtualHost>
</IfModule>


Letsencrypt
Install python-certbot-apache
sudo certbot --apache -d your_domain -d www.your_domain

/etc/letsencrypt/live & /etc/letsencrypt/archive both need to have permissions set at 755

Node Red – install Node Red and add the palet for mysql
sudo npm install -g node-red-admin

In setting.js
credentialSecret: "xxxxxxxxx"
uncomment require("fs");

adminAuth: {
        type: "credentials",
        users: [{
            username: "admin",
            password: "xxxxxxx",
            permissions: "*"
       }]
    },

https: {
        key: fs.readFileSync('/etc/letsencrypt/live/mydomain.com/p$
        cert: fs.readFileSync('/etc/letsencrypt/live/mydomain.com/$
    },
    requireHttps: true,

NOTE node-red-admin hash-pw sets the password


MYSQL,
Install. Create users with
CREATE USER 'grahamjonesgs'@'%' IDENTIFIED BY 'passwordxxxx'
GRANT ALL PRIVILEGES ON * . * TO 'grahamjonesgs'@'localhost';
Create database readings

Read only user for php
mysql> CREATE USER 'reader'@'%' IDENTIFIED BY 'xxxxxxxxxx'

mysql> GRANT SELECT ON readings.* TO 'reader'@'%';



create table rec_data (
room_id VARCHAR(50) NOT NULL,
value FLOAT NOT NULL,
type VARCHAR(50) NOT NULL,
dt   DATETIME DEFAULT CURRENT_TIMESTAMP);


PHP
sudo apt install php php-mysql libapache2-mod-php


